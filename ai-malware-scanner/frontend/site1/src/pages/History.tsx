import React from 'react';
import { History as HistoryIcon, Calendar, Search, Shield, AlertTriangle } from 'lucide-react';
import Navbar from '@/components/layout/Navbar';
import Footer from '@/components/layout/Footer';
import StatusBadge from '@/components/ui/StatusBadge';

const History = () => {
  // Mock scan history data
  const scanHistory = [
    {
      id: 1,
      date: '2023-10-15T14:30:25',
      filename: 'system_report.pdf',
      scanType: 'File Scan',
      riskScore: 0.12,
      result: 'Clean'
    },
    {
      id: 2,
      date: '2023-10-14T09:45:12',
      filename: 'C:\\ Drive',
      scanType: 'System Scan',
      riskScore: 0.75,
      result: 'Threats Found'
    },
    {
      id: 3,
      date: '2023-10-12T16:20:45',
      filename: 'installer.exe',
      scanType: 'File Scan',
      riskScore: 0.52,
      result: 'Suspicious'
    },
    {
      id: 4,
      date: '2023-10-10T11:15:30',
      filename: 'document.xlsx',
      scanType: 'File Scan',
      riskScore: 0.08,
      result: 'Clean'
    },
    {
      id: 5,
      date: '2023-10-08T13:40:15',
      filename: 'D:\\ Drive',
      scanType: 'System Scan',
      riskScore: 0.22,
      result: 'Clean'
    }
  ];
  
  const getRiskLevel = (score: number): 'high' | 'medium' | 'low' => {
    if (score > 0.7) return 'high';
    if (score > 0.4) return 'medium';
    return 'low';
  };
  
  return (
    <div className="min-h-screen flex flex-col bg-cyber-dark">
      <Navbar />
      
      <main className="flex-1 container mx-auto px-4 py-8">
        <div className="max-w-6xl mx-auto">
          <div className="flex items-center justify-between mb-8">
            <h1 className="text-3xl font-bold flex items-center gap-2">
              <HistoryIcon className="h-6 w-6 text-cyber-blue" />
              Scan History
            </h1>
            
            <div className="relative">
              <Search className="h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
              <input
                type="text"
                placeholder="Search scans..."
                className="pl-10 pr-4 py-2 bg-cyber-dark-blue border border-gray-700 rounded-md focus:outline-none focus:border-cyber-blue/50 text-sm"
              />
            </div>
          </div>
          
          <div className="glass-card rounded-lg overflow-hidden">
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead>
                  <tr className="bg-cyber-dark-blue border-b border-gray-700">
                    <th className="py-4 px-6 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
                      Date & Time
                    </th>
                    <th className="py-4 px-6 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
                      File/Location
                    </th>
                    <th className="py-4 px-6 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
                      Scan Type
                    </th>
                    <th className="py-4 px-6 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
                      Risk Score
                    </th>
                    <th className="py-4 px-6 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
                      Result
                    </th>
                    <th className="py-4 px-6 text-right text-xs font-medium text-gray-400 uppercase tracking-wider">
                      Actions
                    </th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-800">
                  {scanHistory.map((scan) => (
                    <tr 
                      key={scan.id} 
                      className="hover:bg-cyber-dark-blue/50 transition-colors duration-150"
                    >
                      <td className="py-4 px-6 whitespace-nowrap">
                        <div className="flex items-center gap-2">
                          <Calendar className="h-4 w-4 text-gray-400" />
                          <span className="text-sm text-gray-300">
                            {new Date(scan.date).toLocaleString()}
                          </span>
                        </div>
                      </td>
                      <td className="py-4 px-6 whitespace-nowrap text-sm text-gray-300">
                        {scan.filename}
                      </td>
                      <td className="py-4 px-6 whitespace-nowrap">
                        <div className="flex items-center gap-2">
                          {scan.scanType === 'System Scan' ? (
                            <Shield className="h-4 w-4 text-cyber-blue" />
                          ) : (
                            <Search className="h-4 w-4 text-cyber-blue" />
                          )}
                          <span className="text-sm text-gray-300">{scan.scanType}</span>
                        </div>
                      </td>
                      <td className="py-4 px-6 whitespace-nowrap">
                        <StatusBadge level={getRiskLevel(scan.riskScore)} />
                      </td>
                      <td className="py-4 px-6 whitespace-nowrap">
                        <div className="flex items-center gap-2">
                          {scan.result === 'Threats Found' && (
                            <AlertTriangle className="h-4 w-4 text-cyber-red" />
                          )}
                          <span 
                            className={`text-sm ${
                              scan.result === 'Threats Found' 
                                ? 'text-cyber-red' 
                                : scan.result === 'Suspicious' 
                                  ? 'text-cyber-yellow' 
                                  : 'text-cyber-green'
                            }`}
                          >
                            {scan.result}
                          </span>
                        </div>
                      </td>
                      <td className="py-4 px-6 whitespace-nowrap text-right text-sm text-gray-300">
                        <button className="text-cyber-blue hover:text-cyber-blue-glow transition-colors">
                          View Details
                        </button>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
            
            <div className="py-4 px-6 bg-cyber-dark-blue/50 border-t border-gray-800 flex items-center justify-between">
              <div className="text-sm text-gray-400">
                Showing <span className="text-white">5</span> of <span className="text-white">20</span> results
              </div>
              
              <div className="flex items-center gap-2">
                <button className="px-3 py-1 border border-gray-700 rounded-md text-sm text-gray-400 hover:border-cyber-blue/50 hover:text-white transition-colors">
                  Previous
                </button>
                <button className="px-3 py-1 border border-cyber-blue/50 rounded-md text-sm text-white hover:bg-cyber-blue/10 transition-colors">
                  Next
                </button>
              </div>
            </div>
          </div>
          
          <div className="mt-8 text-center text-sm text-gray-400">
            <p>
              Scan history is stored locally. Export your scan history as a CSV file for backup.
            </p>
            <button className="mt-2 text-cyber-blue hover:text-cyber-blue-glow underline transition-colors">
              Export History
            </button>
          </div>
        </div>
      </main>
      
      <Footer />
    </div>
  );
};

export default History;
