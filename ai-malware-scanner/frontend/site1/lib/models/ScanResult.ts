import type { ObjectId } from "mongodb"

export interface ScanResult {
  _id?: ObjectId
  userId?: string
  filename: string
  fileSize: number
  fileType: string
  scanType: "file" | "system" | "drive"
  scanDate: Date
  riskScore: number
  riskLevel: "low" | "medium" | "high"
  verdict: "clean" | "suspicious" | "malicious"
  hash: {
    md5: string
    sha256: string
  }
  staticAnalysis: {
    classification: string
    confidence: number
    features: {
      entropy: number
      fileSize: number
      fileType: string
      sections?: string[]
      imports?: string[]
    }
  }
  dynamicAnalysis: {
    riskLevel: "low" | "medium" | "high"
    suspiciousIndicators: string[]
    networkConnections: string[]
    fileActivity: string[]
    registryChanges?: string[]
    processActivity?: string[]
  }
  threatIntelligence?: {
    status: "found" | "not_found"
    detectionRatio?: string
    firstSeen?: Date
    lastSeen?: Date
    engines?: Array<{
      name: string
      result: string
      category: "clean" | "suspicious" | "malicious"
    }>
  }
  scanDuration: number
  createdAt: Date
  updatedAt: Date
}

export interface SystemScanResult {
  _id?: ObjectId
  userId?: string
  scanType: "system" | "drive"
  scanPath: string
  scanDate: Date
  status: "running" | "completed" | "failed"
  progress: number
  stats: {
    totalFiles: number
    scannedFiles: number
    maliciousFiles: number
    suspiciousFiles: number
    cleanFiles: number
    errorFiles: number
  }
  threats: Array<{
    filename: string
    path: string
    riskScore: number
    verdict: string
    action: "quarantined" | "deleted" | "ignored"
  }>
  scanDuration: number
  createdAt: Date
  updatedAt: Date
}
